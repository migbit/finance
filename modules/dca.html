<!DOCTYPE html>
<html lang="pt-PT">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DCA</title>
  <link rel="stylesheet" href="../css/styles.pcolor.css">
  <link rel="stylesheet" href="../css/mobile.css">
  <link rel="icon" href="../favicon.ico" type="image/x-icon" />
  <link rel="manifest" href="../manifest.json">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
</head>

<body data-page="dca">
  <!-- Hamburger icon (always visible on mobile) -->
  <button id="menu-icon" aria-label="Open menu">‚ò∞</button>
  
  <!-- Header / Nav -->
  <header>
    <nav id="nav-menu">
      <ul>
        <!-- Login/User section at top -->
        <li id="login-section" class="login-block">
          <a href="#" id="login-btn" class="login-visible">üîê Login</a>
          <span id="user-info" class="user-visible" style="display:none;">
            <a href="#" id="user-name">üë§ Username</a>
          </span>
        </li>

        <li class="separator"></li>

        <!-- Sec√ß√£o: Apartamentos -->
        <li class="menu-title">Apartamentos</li>
        <li><a href="faturas.html">üìÑ Faturas</a></li>
        <li><a href="analise.html">üìä An√°lise</a></li>
        <li><a href="analise123.html">üè† 123</a></li>
        <li><a href="analise1248.html">üè† 1248</a></li>
        <li><a href="analise123vs1248.html">‚öñÔ∏è 123 vs 1248</a></li>
        <li><a href="caixa.html">üí∞ Caixa</a></li>
        <li><a href="tmt.html">üß≥ Taxa Tur√≠stica</a></li>
        <li><a href="diversos.html">üìã Diversos</a></li>

        <li class="separator"></li>

        <!-- Sec√ß√£o: Investimentos -->
        <li class="menu-title">Investimentos</li>
        <li><a href="dca.html" class="active">üìà DCA</a></li>
        <li><a href="crypto.html">üöÄ Cripto</a></li>
      </ul>
    </nav>
  </header>

  <main class="dca-page">
    <!-- === T√≠tulo === -->
    <h2 class="page-title center">DCA ‚Äì Trade Republic</h2>

    <!-- === Par√¢metros === -->
    <section class="report-section">
      <div class="viz-card params-card">
        <h4>Par√¢metros</h4>
        <div class="table-wrap">
          <table class="table-dca params-table" id="params-table">
            <thead>
              <tr>
                <th class="num">Data final</th>
                <th class="num">VWCE %</th>
                <th class="num">AGGH %</th>
                <th class="num">Contribui√É¬ß√É¬£o Mensal</th>
                <th style="width:140px">A√É¬ß√É¬µes</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="num"><input id="end-date" type="month" /></td>
                <td class="num"><input id="pct-swda" type="number" min="0" max="100" step="0.01" /></td>
                <td class="num"><input id="pct-aggh" type="number" min="0" max="100" step="0.01" /></td>
                <td class="num">
                  <div class="input-euro">
                    <input id="monthly-contribution" type="number" step="1" value="152" />
                  </div>
                </td>
                <td style="text-align:right">
                  <button id="btn-save-params" type="button" class="primary">Editar/Gravar</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- === KPIs & Cen√°rios === -->
    <section class="report-section">
      <div class="viz-card" id="kpi-cenarios-card">
        <h4 style="margin-bottom: .5rem;">KPIs & Cen√°rios</h4>
        
        <!-- Current Performance KPIs -->
        <div class="kpi-grid enhanced">
          <div class="kpi-item enhanced">
            <div class="kpi-label">Total Investido</div>
            <div class="kpi-value" id="kpi-total-invested">-</div>
          </div>
          <div class="kpi-item enhanced">
            <div class="kpi-label">Valor Atual</div>
            <div class="kpi-value" id="kpi-current-value">-</div>
          </div>
          <div class="kpi-item enhanced">
            <div class="kpi-label">Resultado</div>
            <div class="kpi-value" id="kpi-result">-</div>
            <div class="kpi-sub" id="kpi-result-pct">-</div>
          </div>
          <div class="kpi-item enhanced">
            <div class="kpi-label">Juros Acum.</div>
            <div class="kpi-value" id="kpi-total-interest">-</div>
          </div>
        </div>

        <!-- Investment Progress Doughnut -->
        <div class="kpi-grid">
          <div class="kpi-item donut-card">
            <div class="donut-canvas"><canvas id="kpi-inv"></canvas></div>
            <div class="kpi-caption">Progresso do Investimento</div>
          </div>
        </div>

        <!-- Scenario Comparison -->
        <div class="scenario-comparison" style="margin-top: 1.5rem;">
          <h5 style="text-align: center; margin-bottom: 1rem; color: var(--text-dim);">Cen√°rios de Retorno Anual</h5>
          <div class="scenario-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div class="scenario-card" data-scenario="conservative">
              <div class="scenario-header" style="background: #e8f5e8; padding: 0.75rem; border-radius: 8px 8px 0 0;">
                <div class="scenario-title" style="font-weight: 700; color: #2e7d32;">Conservador</div>
                <div class="scenario-rate" style="font-size: 0.9rem; color: #2e7d32;">3% anual</div>
              </div>
              <div class="scenario-body" style="padding: 0.75rem; background: white; border-radius: 0 0 8px 8px;">
                <div class="scenario-value" id="scenario-conservative">-</div>
              </div>
            </div>
            <div class="scenario-card" data-scenario="moderate">
              <div class="scenario-header" style="background: #e3f2fd; padding: 0.75rem; border-radius: 8px 8px 0 0;">
                <div class="scenario-title" style="font-weight: 700; color: #1565c0;">Moderado</div>
                <div class="scenario-rate" style="font-size: 0.9rem; color: #1565c0;">5% anual</div>
              </div>
              <div class="scenario-body" style="padding: 0.75rem; background: white; border-radius: 0 0 8px 8px;">
                <div class="scenario-value" id="scenario-moderate">-</div>
              </div>
            </div>
            <div class="scenario-card" data-scenario="optimistic">
              <div class="scenario-header" style="background: #fff3e0; padding: 0.75rem; border-radius: 8px 8px 0 0;">
                <div class="scenario-title" style="font-weight: 700; color: #ef6c00;">Otimista</div>
                <div class="scenario-rate" style="font-size: 0.9rem; color: #ef6c00;">7% anual</div>
              </div>
              <div class="scenario-body" style="padding: 0.75rem; background: white; border-radius: 0 0 8px 8px;">
                <div class="scenario-value" id="scenario-optimistic">-</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- === Juro === -->
    <section class="report-section">
      <div class="viz-card juro-card">
        <h4>Juro</h4>
        <div class="table-wrap">
          <table class="table-dca" id="juro-table">
            <thead>
              <tr>
                <th class="num">Saldo</th>
                <th class="num">Taxa de juro</th>
                <th class="num">Valor mensal</th>
                <th class="num">Valor ganho em Juros</th>
                <th style="text-align:center">A√ß√µes</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="num">
                  <div class="input-euro">
                    <input id="juro-saldo" type="number" step="0.01" class="cell" placeholder="0,00" inputmode="decimal" />
                  </div>
                </td>
                <td class="num">
                  <input id="juro-taxa" type="number" step="0.01" class="cell" value="2.00" disabled />
                </td>
                <td class="num"><span id="juro-mensal">0 ‚Ç¨</span></td>
                <td class="num"><span id="juro-acumulado">0 ‚Ç¨</span></td>
                <td style="text-align:center">
                  <button id="btn-juro-editar" type="button">Editar</button>
                  <button id="btn-juro-gravar" type="button">Gravar</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- === Registo Mensal === -->
    <section class="report-section">
      <div class="viz-card">
        <h4>Registo Mensal</h4>
        <div class="table-wrap" id="dca-table-wrap"><!-- tabela via JS --></div>
        <div class="center" style="margin-top: 1rem;">
          <button id="toggle-others" type="button">Expandir anos</button>
        </div>
      </div>
    </section>

  </main>

  <script type="module" src="../js/dca.js"></script>
  <script>
    const menuIcon = document.getElementById('menu-icon');
    const navMenu  = document.getElementById('nav-menu');
    if (menuIcon && navMenu) menuIcon.addEventListener('click', () => navMenu.classList.toggle('active'));
  </script>
</body>
</html>